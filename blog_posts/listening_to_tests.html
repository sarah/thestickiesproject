It has been a long time since I wrote serious javascript; I think the last time I did what I would call an actual 'javascript application' was in 2002, or so. Sure, I've written a few things here and there. In fact, at the startup I worked at, I wrote a couple in-browser things that I was proud of at the time (looking back, naturally, I can see the parts that I'm not so proud of). But, all-in-all, most of what I do has been pretty non-dynamic. Back in 2002, I'm pretty sure I was only seeing the beginnings of javascript frameworks. There were some libraries coming out, but I seem to remember them being very focused on hiding the differencies between DOM implementations. I wrote a couple things back then, but nothing incredibly crazy; I remember writing a client-side form validation library that was pretty damn sweet for the time. :)

So, as I've said before, both my javascript and javascript testing skills were a bit rusty. I've used this as an example before when talking about using the term 'pragmatic' to really be a cover over lack of skill: I never tested my javascript, not because I was pragmatic about testing, but because I flat-out didn't have the skills needed to do it effectively. This was one of the reasons I was so excited to work on The Stickies Project: as I outlined initially, this application is going to be almost entirely javascript, so I will have a great opportunity to patch what I consider a significant hole in my skillset.

After setting up BlueRidge, I began writing some examples for my code, but I found that, while I was writing tests, I wasn't really doing TDD. I was writing some functions, trying to figure out how to get the desired behavior, while writing tests alongside them. I'll take a look at the functionality that I wrote for managing the jEditable component's inline editing.

At first, I was just trying to get things working, figuring out how the component worked, so I wrote the following code:

<script src="http://gist.github.com/268132.js?file=update_sticky_text.js"></script>
<script src="http://gist.github.com/268132.js?file=specs.js"></script>

Yeah, looks pretty bad. But, it was enough to learn the jEditable component, so I was pretty happy. However, I definitely had a few major problems with the code:

- global function
- no sense of cohesion other than being in the same file for these two functions, even though the dependency was there
- #sticky_update_url_for was not used anywhere else, only by #update_sticky_text
- no test coverage for the #update_sticky_text function.

Before moving on, we took a bit of time to learn some more about ScrewUnit. I had learned the expect(...).to(...) syntax, but wasn't sure what the setup was for checking if methods are called. I'm tend to do collaboration-style tests, so it is important for me to be able to set expectations on method calls. I wasn't ready to jump into using a mocking framework, yet, so I decided to stick with the simplest way I knew how: replace the method with your own that sets a flag if it was called. Something like this would suffice:

<script src="http://gist.github.com/268132.js?file=expect_called.js"></script>

This is the easiest way to check if something was called, but, of course, it doesn't replace the function at the end (I wrote that later), so it isn't perfect. But, this allowed me to write isolation-based examples for my functions. This allowed me to write a full set of example for what had become known as #old_update_sticky_text:

<script src="http://gist.github.com/268132.js?file=describe_old_update_sticky_text.js"></script>

So, I was pretty happy that I was able to write isolation tests, but I was still annoyed by the other problems, primarily what I considered to be the big problems of global functions and lack of a sense of cohesion. My experiences have led me to trust in TDD to guide me when I'm not 100% sure where to go. Let's get going. I've comfortable enough with ScrewUnit now, so I thought I would just jump in head-first.

First example? How about this:

<script src="http://gist.github.com/268132.js?file=first_tsp_spec.js"></script>

It felt somewhat reasonable. This is a handler across all the sticky object editable components, so hanging off a TSP (the stickies project) object feels like it will at least afford me a bit of cohesion while I figure out a better method.

Now, to get it passing:

<script src="http://gist.github.com/268132.js?file=first_tsp.js"></script>

There, that made it passed, plus satisfied the first behavior that the jEditable component required: the handler returns the new value. In our case, we didn't need anything fancy, so this was good enough. Of course, this didn't do much, so we need to add the code that would interact with the back-end. The jEditable component executes the handler in the context of the inline editor div, so 'this' would be that div. The scheme for a sticky was starting to look like:

<script src="http://gist.github.com/268132.js?file=sticky_schema_1.html"></script>

Looking at this, and knowing that we were executing in the context of div.editable, it seemed naturally to have a 2-step process for updating the sticky:

- get a sticky object from the div.editable
- call #update_content on the sticky object

This seemed like a reasonable abstraction, as it freed us from worrying too much about what the heck 'update_content' needed to do; we can get to that later. For now, we could just put a console.log() call into it. Well, since we were starting to work with a slightly more complicated setup, we needed a bit more power with 
